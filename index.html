<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/typography.css">
    <link rel="stylesheet" href="css/buttons_links.css">
    <link rel="stylesheet" href="css/header_navigation.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="js/navigation.js"></script>
    <script src="js/steamApi.js"></script>
    <title>KHPP</title>
</head>
<body>
    <header>
        <div class="flex">
            <h1>KHPP</h1>
            <!-- <h3>Kanta-Hämeen Paskimmat Pelaajat</h3> -->
            <!-- Top Navigation Menu -->
            <div class="topnav">
                <!-- <a href="#home" class="active">Logo</a> -->
                <!-- Navigation links (hidden by default) -->
                <div id="myLinks" class="linksSection">
                <a href="#news">News</a>
                <a href="#contact">Contact</a>
                <a href="#about">About</a>
                </div>
                <!-- "Hamburger menu" / "Bar icon" to toggle the navigation links -->
                <a href="javascript:void(0);" class="icon" onclick="myFunction()">
                <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
    </header>
    
    <main>
        <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Dignissimos dolor accusamus neque laborum atque accusantium perspiciatis, in illo itaque assumenda totam. Facilis, voluptatum ipsum excepturi similique facere unde quos necessitatibus quia culpa
            eligendi consequuntur vero quas eum dolorem voluptates laboriosam? Dolor neque quas minus numquam laboriosam magni voluptatem enim eveniet.</p>
    
        <h1>Steam Profiilitiedot</h1>
    
        <div id="profile">
            <p><strong>Pelaajan nimi:</strong> <span id="playerName">Ladataan...</span></p>
            <p><strong>Profiilin URL:</strong> <span id="profileUrl">Ladataan...</span></p>
        </div>



        <h1>Steam Profiilitiedot</h1>
    
        <div id="profile">
            <p><strong>Pelaajan nimi:</strong> <span id="playerName">Ladataan...</span></p>
            <p><strong>Profiilin URL:</strong> <a href="" id="profileUrl" target="_blank">Ladataan...</a></p>
            <img id="profileAvatar" src="" alt="Avatar" width="100">
            <p><strong>Reaali-nimi:</strong> <span id="realName">Ladataan...</span></p>
        </div>
        
        <script>
            async function getSteamProfile() {
                const corsProxy = 'https://cors-anywhere.herokuapp.com/';
                const steamApiUrl = 'https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=EC5728BA25DE2647D995F373555E2E7C&steamids=76561197970941149';
                
                // Fetch-pyyntö, jossa lisätään tarvittavat otsikot
                const response = await fetch(corsProxy + steamApiUrl, {
                    method: 'GET',
                    headers: {
                        'Origin': window.location.origin,  // Lisätään Origin-otsikko
                        'X-Requested-With': 'XMLHttpRequest'  // Lisätään X-Requested-With-otsikko
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log(Vastausok mutta ladataan);
                    
                    if (data.contents) {
                        const apiData = JSON.parse(data.contents); // Puramme välimuistista saadun JSON:n
                        const playerData = apiData.response.players[0];
                        
                        document.getElementById('playerName').textContent = playerData.personaname;
                        document.getElementById('profileUrl').href = playerData.profileurl;
                        document.getElementById('profileUrl').textContent = playerData.profileurl;
                        document.getElementById('profileAvatar').src = playerData.avatarfull;
                        document.getElementById('realName').textContent = playerData.realname;
                    } else {
                        document.getElementById('playerName').textContent = 'Tietojen hakeminen epäonnistui';
                    }
                } else {
                    document.getElementById('playerName').textContent = 'API-pyyntö epäonnistui';
                }
            }
    
            getSteamProfile();
        </script>
    </main>
</body>
</html>